---
title: "2017 Annual Report"
output: 
  flexdashboard::flex_dashboard:
    vertical_layout: scroll
    logo: img/logo.png
    favicon: img/fav.png
    orientation: rows
    self_contained: true
    navbar:
      - { title: "OIPM Home", href: "http://nolaipm.gov", align: right }
---

```{r setup, echo = FALSE, cache = FALSE, include = FALSE}
library(flexdashboard)
source("annual_report_2017.R")
source("analysis/force/force_by_year.R")
source("analysis/force/force_by_month.R")
source("analysis/force/uof_by_type.R")
source("analysis/force/uof_by_level_and_year.R")
source("analysis/force/uof_pies_each_type.R")
source("analysis/force/uof_by_officer_age_exp.R")
source("analysis/force/uof_by_victim_sex_race.R")
source("analysis/force/uof_by_officer_sex_race.R")
source("analysis/force/uof_by_district_level.R")
source("analysis/officers/officer_demographics.R")
source("analysis/officers/officer_zips.R")
source("analysis/complaints/complaints_allegations_by_year.R")
source("analysis/complaints/complaints_allegations_by_month.R")
source("analysis/complaints/allegations_by_type.R")
source("analysis/complaints/complaints_by_outcome.R")
source("analysis/complaints/complaints_allegation_sex_race_disposition.R")
```

Introduction {data-orientation=columns}
===================================== 

Column
-------------------------------------

### ATTENTION: THIS IS A DRAFT!
OIPM's 2017 annual report is currently a work in progress. All analysis and data contained on this website should not be relied on until the official report is
released. 

**WORK IN PROGRESS**
![alt text](img/wip.png "WORK IN PROGRESS")

### Navigating the report
This website is an interactive version of the statiscal analysis from OIPM's 2017 annual report Annual Report. Analysis is divided into these sections:

1. [Use of Force](#use-of-force)
2. [Complaints & Discipline](#complaints)
3. [Officer Demographics](#officers)
4. [Body-worn camera adherence](#bodyworn-cameras)

Column
-------------------------------------
### ATTENTION: THIS IS A DRAFT!
OIPM's 2017 annual report is currently a work in progress. All analysis and data contained on this website should not be relied on until the official report is
released. 

**WORK IN PROGRESS**
![alt text](img/wip.png "WORK IN PROGRESS")

### Reproducing this report

#### tl;dr
```
git clone https://github.com/marvinmarnold/oipm_annual_report
Rscript run.R
```

#### Source
The data and scripts used to generate this website are available [here](https://github.com/marvinmarnold/oipm_annual_report).

#### Dependencies
The report was written in Rmarkdown using Rstudio and has the following dependencies that can be installed using `install.packages("LIBRARY_NAME")`:

- dplyr
- tidyr
- ggplot2
- rmarkdown
- flexdashboard
- plotly
- pandoc (read troubleshooting notes)
- maps
- devtools::install_github('rstudio/leaflet')
- geojsonio (on ubuntu, installation fails many times and instructs to install dependencies)

e.g.: `install.packages(c("dplyr", "tidyr", "ggplot2", "rmarkdown", "plotly", "flexdashboard", "maps", "pandoc", "leaflet"))`

#### Build and run
Once you have all the dependencies installed, you can clone the repository and use Knit in Rstudio to compile `index.Rmd`
in the project's root.

#### Troubleshooting

##### Pandoc
If you have trouble with Pandoc on Linux, check out [these instructions](https://github.com/rstudio/rmarkdown/blob/master/PANDOC.md#newer-systems-debianubuntufedora).

##### geojsonio
`sudo apt install libgdal1-dev libgdal1i libproj-dev libudunits2-dev` then `install.packages("rgdal", repos = "http://cran.us.r-project.org", type = "source")`. You'll probably also need to update your gdal version:

https://stackoverflow.com/questions/37294127/python-gdal-2-1-installation-on-ubuntu-16-04#41613466

Then finally: `install.packages("geojsonio")`

#### Resources
If you want to get map data for other states, check out: https://github.com/jgoodall/us-maps then convert with ogre.adc4gis.com.
Use the entire ZIP that you download, when converting, don't need to extract. (Alternative = https://github.com/OpenDataDE/State-zip-code-GeoJSON)

Use of force {data-orientation=rows}
===================================== 

Row 
-------------------------------------
### ATTENTION: THIS IS A DRAFT!
OIPM's 2017 annual report is currently a work in progress. All analysis and data contained on this website should not be relied on until the official report is
released. 

**WORK IN PROGRESS**
![alt text](img/wip.png "WORK IN PROGRESS")

Row 
-------------------------------------
### FTN vs UOF
FTN stands for “force tracking number”. It is the designation given to track the entirety
of an interaction between NOPD and one or more individuals wherein force was used.

A single FTN corresponds to one or more UOF. If Officer A and Officer B both use their
hands against Individual C, the result would be one FTN, corresponding to two UOFs
(one for each officer). The same pattern would apply if there were multiple types of
force used or multiple individuals that force was used on.

This report will always clearly label whether FTN or UOF is being used for a particular
analysis but the onus is on the reader to remain vigilant of the distinction.

Row
-------------------------------------
### Use of force by year

Force jumps between 2014 and 2015 because of new rules about what constitutes force. 
UOF has been rising but FTN about steady. More <officers, victims, types of force> used per force incident.
2015 is the first year that the database that we access (IAPro) was used. Before then, we have to rely on
historic numbers from NOPD.

Furthermore, 2017 is the first year th OIPM has had access to the underlying database. Now that we have access
we find discrepancies with what NOPD previously reported to us. 

As of this writing, there are no major differences in FTNs in 2015

```{r force.by.year, fig.width = 10, fig.height = 6}
p.force.by.year
```


### FTN & UOF in 2017 by month
UOF and FTN both peak in Feb and Aug. This corresponds with Mardi Gras and the summer.
UOF per FTN ranges from 2.6 - 4.5.

TODO: What is driving UOF most: citizens, types of force, num officers

```{r, fig.width = 10, fig.height = 6}
p.force.by.month
```

Row
-------------------------------------
### Level 1
```{r, fig.height = 3}
p.lvl.by.year[[1]]
```

### Level 2
```{r, fig.height = 3}
p.lvl.by.year[[2]]
```

### Level 3
```{r, fig.height = 3}
p.lvl.by.year[[3]]
```

### Level 4
```{r, fig.height = 3}
p.lvl.by.year[[4]]
```

Row
-------------------------------------
### Force by level and type of force
```{r, fig.width = 10, fig.height = 6}
p.uof.by.type
```

### Force by level and type of force
```{r, fig.width = 10, fig.height = 6}
p.uof.by.district.type
```


Row
-------------------------------------
### Level 1
```{r, fig.height = 3}
uof.pies.each.type[[1]]
```

### Level 2
```{r, fig.height = 3}
uof.pies.each.type[[2]]
```

### Level 3
```{r, fig.height = 3}
uof.pies.each.type[[3]]
```

### Level 4
```{r, fig.height = 3}
uof.pies.each.type[[4]]
```

Row
-------------------------------------
### Force by officer age and experience 
As officers get older, they commit less force. Officers 31 - 35 make up 14% of the police department but are responsible for 
over 500 incidents of force. In the next age bucket, officers 26 - 40 make up 35% of all police (nearly double the previous bucket)
but amount of force decreases.

Experience levels are not enough to explain use of force. 
Officers older than 31 tends to have over 5 years experience but continue to use non-negligible amounts of force.

```{r, fig.width = 10, fig.height = 5}
p.uof.by.officer.age.exp
```

Row
-------------------------------------
### Analysis of UOF by victim gender and race
Males have force used against them more often. Racial breakdown of how force is used almost identical for both males and females.
Black people of both genders are victims of force about 79% of the time.

Black and hispanic people are most exposed to Firearms but white people get hands. Asians have so little force, can't say much 


Row
-------------------------------------
### UOF by victim gender and race
```{r, fig.width = 5, fig.height = 4}
p.uof.by.victim.sex.race
```

### UOF by female victim race
```{r, fig.width = 5, fig.height = 4}
p.uof.by.female.victim.race
```

### UOF by male victim race
```{r, fig.width = 5, fig.height = 4}
p.uof.by.male.victim.race
```

Row
-------------------------------------
### Female victim UOF by type and race
```{r, fig.width = 5, fig.height = 5}
p.female.victim.uof.by.type
```

### Male victim UOF by type and race
```{r, fig.width = 5, fig.height = 5}
p.male.victim.uof.by.type
```


Row
-------------------------------------
### Analysis of UOF by officer gender and race

TODO


Row
-------------------------------------
### UOF by officer gender and race
```{r, fig.width = 5, fig.height = 4}
p.uof.by.officer.sex.race
```

### UOF by female officer race
```{r, fig.width = 5, fig.height = 4}
p.uof.by.female.officer.race
```

### UOF by male officer race
```{r, fig.width = 5, fig.height = 4}
p.uof.by.male.officer.race
```

Row
-------------------------------------
### Female officer UOF by type and race
```{r, fig.width = 5, fig.height = 5}
p.female.uof.by.type
```

### Male officer UOF by type and race
```{r, fig.width = 5, fig.height = 5}
p.male.uof.by.type
```

Complaints
=====================================

Row 
-------------------------------------
### ATTENTION: THIS IS A DRAFT!
OIPM's 2017 annual report is currently a work in progress. All analysis and data contained on this website should not be relied on until the official report is
released. 

**WORK IN PROGRESS**
![alt text](img/wip.png "WORK IN PROGRESS")

Row
-------------------------------------
### Complaints vs allegation
When one or more individuals complain about an officer, a single tracking number is created. Each of these unique tracking numbers is considered a single complaint. Each complaint can contain one or more allegations of misconduct. 

Furthermore, its possible that each complaint/allegation is intiated by either a supervisor or anybody who is not their supervisor (including other officers). Complaints/allegations initiated by a superior are called "Rank Initiated" while all other complaints are "Citizen Initiated".

When a complaint/case contains more than one finding, select disposition in this order:
1. Sustained
2. Withdrawn / mediated
3. DI-2
4. Pending
5. Not sustained
6. Unfounded
7. Exonerated
8. NFIM
9. Illegitimate outcome

Row
-------------------------------------
### Complaints by year
```{r, fig.width = 5, fig.height = 3}
p.complaints.by.year
```

### Allegations by year
```{r, fig.width = 5, fig.height = 3}
p.allegations.by.year
```

Row
-------------------------------------
### Complaints and allegations by month
```{r, fig.width = 5, fig.height = 5}
p.complaints.allegations.by.month
```

### Complaints by month and initiator
```{r, fig.width = 5, fig.height = 5}
p.complaints.by.month
```

### Allegations by month and initiator
```{r, fig.width = 5, fig.height = 5}
p.allegations.by.month
```

Row
-------------------------------------
### Individual allegations by outcome
```{r, fig.width = 5, fig.height = 10}
p.allegation.by.type.disposition
```

Row
-------------------------------------
### All complaints by outcome
```{r, fig.width = 5, fig.height = 4}
p.complaint.by.outcome
```

### Rank complaints by outcome
```{r, fig.width = 5, fig.height = 4}
p.rank.complaint.by.outcome
```

### Citizen complaints by outcome
```{r, fig.width = 5, fig.height = 4}
p.citizen.complaint.by.outcome
```

Row
-------------------------------------
### How officer race impacts disposition
```{r, fig.width = 5, fig.height = 7}
p.allegation.race.disposition
```

Officers
===================================== 

Row 
-------------------------------------
### ATTENTION: THIS IS A DRAFT!
OIPM's 2017 annual report is currently a work in progress. All analysis and data contained on this website should not be relied on until the official report is
released. 

**WORK IN PROGRESS**
![alt text](img/wip.png "WORK IN PROGRESS")

Row
-------------------------------------
### Total number active officers
```{r, fig.width = 5, fig.height = 5}
p.active.officers
```

### 2017 active officers by race
```{r, fig.width = 5, fig.height = 5}
p.officers.by.race
```

### 2017 active officers by sex
```{r, fig.width = 5, fig.height = 5}
p.officers.by.sex
```

Row
-------------------------------------
### Where officers live by zip
```{r, fig.width = 5, fig.height = 5}
p.officer.map
```


Bodyworn Cameras
===================================== 
Row 
-------------------------------------
### ATTENTION: THIS IS A DRAFT!
OIPM's 2017 annual report is currently a work in progress. All analysis and data contained on this website should not be relied on until the official report is
released later this year.

**WORK IN PROGRESS**
![alt text](img/wip.png "WORK IN PROGRESS")


Row
-------------------------------------
### Preliminary results
27561 epr are missing corresponding bwc entries, that's equivalent to 22.7% missing

